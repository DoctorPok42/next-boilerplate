FROM node:alpine

ARG SERVER_URL
ARG SERVER_PORT
ARG MONGO_URI
ARG JWT_SECRET
ARG TOKEN_EXPIRATION

ENV SERVER_URL=$SERVER_URL
ENV PORT=$SERVER_PORT
ENV MONGO_URI=$MONGO_URI
ENV JWT_SECRET=$JWT_SECRET
ENV TOKEN_EXPIRATION=$TOKEN_EXPIRATION

WORKDIR /app

COPY package*.json ./

RUN npm install --ignore-scripts

COPY . ./

RUN npm run build

EXPOSE $PORT

CMD ["npm", "run", "start"]
